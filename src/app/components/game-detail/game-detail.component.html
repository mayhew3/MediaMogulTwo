<div class="modal-header">
  <h1>Update Game</h1>
  <button type="button"
          class="btn btn-warning close"
          aria-label="Close"
          (click)="activeModal.dismiss('Cross click')">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<div class="modal-body"
     *ngIf="!!game">

  <h3 *ngIf="!titleEditMode">{{game.title.value}} <span (click)="toggleTitleEdit()"
                                                  *ngIf="personService.isAdmin">
    <svg class="bi bi-pencil" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
      <path fill-rule="evenodd" d="M11.293 1.293a1 1 0 011.414 0l2 2a1 1 0 010 1.414l-9 9a1 1 0 01-.39.242l-3 1a1 1 0 01-1.266-1.265l1-3a1 1 0 01.242-.391l9-9zM12 2l2 2-9 9-3 1 1-3 9-9z" clip-rule="evenodd"/>
      <path fill-rule="evenodd" d="M12.146 6.354l-2.5-2.5.708-.708 2.5 2.5-.707.708zM3 10v.5a.5.5 0 00.5.5H4v.5a.5.5 0 00.5.5H5v.5a.5.5 0 00.5.5H6v-1.5a.5.5 0 00-.5-.5H5v-.5a.5.5 0 00-.5-.5H3z" clip-rule="evenodd"/>
    </svg>
  </span></h3>

  <div class="input-group"
       *ngIf="titleEditMode">
    <!--suppress HtmlFormInputWithoutLabel -->
    <input type="text"
           class="form-control darkInput"
           [(ngModel)]="game.title.value"/>
    <div class="input-group-append">
      <button class="btn btn-default"
              (click)="updateTitle()"
              type="button">Update</button>
    </div>
  </div>


  <form>
    <div class="row">

      <!--PLATFORM-->
      <div class="col-4">
        <label class="col-form-label" for="platform">Platform</label>
        <select class="custom-select darkInput"
                id="platform"
                name="platform"
                [(ngModel)]="game.platform.value">
          <option *ngFor="let platform of getPlatformOptions()"
                  [selected]="getDisplayValueOf(platform) === game.platform.value"
                  (click)="updatePlatform(platform)">{{getDisplayValueOf(platform)}}</option>
        </select>
      </div>

      <!--METACRITIC HINT-->
      <div class="col-4">
        <label class="col-form-label" for="metacriticHint">Metacritic Hint</label>
        <input type="text"
               id="metacriticHint"
               class="darkInput form-control"
               name="metacriticHint"
               [(ngModel)]="game.metacritic_hint.value"
               (ngModelChange)="onFieldEdit()"/>
      </div>

      <!--NATURAL END-->
      <div class="col-4">
        <label class="col-form-label" for="naturalEnd">Natural End</label>
        <input type="checkbox"
               id="naturalEnd"
               name="naturalEnd"
               class="form-control"
               (change)="onFieldEdit()"
               [(ngModel)]="game.natural_end.value">
      </div>

      <!--RATING-->
      <div class="col-4" *ngIf="hasPerson()">
        <label class="col-form-label" for="rating">Rating</label>
        <input type="number"
               id="rating"
               name="rating"
               class="darkInput form-control"
               [(ngModel)]="game.personGame.rating.value"
               (ngModelChange)="onFieldEdit()"/>
      </div>

      <!--HOWLONG-->
      <div class="col-4">
        <label class="col-form-label" for="howlong">Howlong ID</label>
        <input type="number"
               id="howlong"
               name="howlong"
               class="darkInput form-control"
               [(ngModel)]="game.howlong_id.value"
               (ngModelChange)="onFieldEdit()"/>
      </div>

      <!--GIANTBOMB-->
      <div class="col-4">
        <label class="col-form-label" for="giantbomb">GiantBomb ID</label>
        <input type="number"
               id="giantbomb"
               name="giantbomb"
               class="darkInput form-control"
               [(ngModel)]="game.giantbomb_id.value"
               (ngModelChange)="onFieldEdit()"/>
      </div>

      <!--FINISHED-->
      <div class="col-4" *ngIf="hasPerson()">
        <label class="col-form-label" for="finished">Finished</label>
        <input type="checkbox"
               id="finished"
               name="finished"
               class="form-control"
               (change)="onFinishedFieldEdit()"
               [(ngModel)]="finished">
      </div>

      <!--FINAL SCORE-->
      <div class="col-4" *ngIf="hasPerson() && !!finished">
        <label class="col-form-label" for="finalScore">Final Score</label>
        <input type="number"
               id="finalScore"
               name="finalScore"
               class="darkInput form-control"
               [(ngModel)]="game.personGame.final_score.value"
               (ngModelChange)="onFieldEdit()"/>
      </div>

      <!--REPLAY SCORE-->
      <div class="col-4" *ngIf="hasPerson() && !!finished">
        <label class="col-form-label" for="replay">Replay</label>
        <input type="number"
               id="replay"
               name="replay"
               class="darkInput form-control"
               [(ngModel)]="game.personGame.replay_score.value"
               (ngModelChange)="onFieldEdit()"/>
      </div>


    </div>

  </form>
</div>

<div class="modal-footer">
  <button type="button"
          class="btn btn-primary"
          [disabled]="!anyFieldsChanged()"
          (click)="changeValues()">Update and Close</button>
</div>
